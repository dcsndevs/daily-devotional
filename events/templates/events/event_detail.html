{% extends 'base.html' %}

{% load static %}
{% load crispy_forms_tags %}


{% block title %}
    {{ post.title }}
{% endblock %}

{% block content %}
<div class="container">
        <h1>{{ post.title }}</h1>

    <p>{{ post.description }}</p>
    <p>{{ post.date_of_event }}</p>

    <p>{{ post.slot }}</p>

    <p>{{ post.date_of_event }}</p>

    <p>{{ post.registration_expires }}</p>

    <p>{{ post.location }}</p>

    <p>Remaining Slot: {{ remaining_slot }}</p>

    <hr>
    {% if remaining_slot == 0 %}
    <h2 style="min-height: 48vh;">This programme is fully booked.</h2>
    {% else %}
        <div>
            {% if user.is_authenticated %}
            <div class="row" style="min-height: 48vh;">
                <div class="col-md-8 mt-3 offset-md-2">
                    <form method="post">
                        <div style="display: none;">
                            {{ form | crispy }}
                            {% csrf_token %}
                        </div>
                        
                            <input type="hidden" name="event" value="{{ post.id }}">
                        <button class="btn btn-warning" type="submit">Register</button>
                    </form> 
                </div>
                
            </div>
                
            {% else %}
            <div class="row">
                <h3>Register for this event</h3>
                <p><a href="{% url 'account_login' %}">Login</a> for faster experience</p>
            </div>
            <form method="post">
                {{ form | crispy }}
                {% csrf_token %}
                <input type="hidden" name="event" value="{{ post.id }}">
                <button class="btn btn-warning" type="submit">Register</button>
            </form>    
            {% endif %}
        </div>
    {% endif %}
    
</div>

{% endblock %}
